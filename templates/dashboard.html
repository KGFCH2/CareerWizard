
{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="panel">
    <h2>Skill → Career Recommendations</h2>
    <p class="small">Type a few skills (comma separated). Example: python, sql, statistics, communication</p>
    <form id="rec-form" class="row" onsubmit="return false;">
      <input id="skills" class="input" placeholder="Your skills...">
      <div>
        <button class="btn" onclick="getRecs()">Recommend</button>
        <input id="search" class="input" placeholder="Search skills/careers... (instant suggestions)" oninput="suggest(this.value)">
        <div class="small" id="sugg"></div>
      </div>
    </form>
    <div id="results" style="margin-top:12px;"></div>
  </div>
  <div class="panel">
    <h2>Career Advisor Chat</h2>
    <div id="chatbox" class="chatbox"></div>
    <form id="chat-form" style="display:flex; gap:8px; margin-top:8px;">
      <input id="chat-input" class="input" placeholder="Say 'Hi' or list your skills...">
      <button class="btn">Send</button>
    </form>
    <div class="small">Try: "What should I learn for data analyst?"</div>
  </div>
</div>

<div class="panel" style="margin-top:16px;">
  <h2>Top Learning Sites</h2>
  <div class="grid3">
    <a class="card" href="https://www.coursera.org/" target="_blank"><b>Coursera</b><p class="small">University-grade content</p></a>
    <a class="card" href="https://www.edx.org/" target="_blank"><b>edX</b><p class="small">MicroMasters and more</p></a>
    <a class="card" href="https://www.udacity.com/" target="_blank"><b>Udacity</b><p class="small">Nanodegrees</p></a>
    <a class="card" href="https://www.freecodecamp.org/" target="_blank"><b>freeCodeCamp</b><p class="small">Hands-on coding</p></a>
    <a class="card" href="https://www.kaggle.com/learn" target="_blank"><b>Kaggle</b><p class="small">Short practical ML lessons</p></a>
    <a class="card" href="https://developer.mozilla.org/" target="_blank"><b>MDN Web Docs</b><p class="small">Web development docs</p></a>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/chat.js') }}"></script>
<script>
async function getRecs(){
  const skills = document.getElementById('skills').value.split(',').map(s=>s.trim()).filter(Boolean);
  const res = await fetch('/api/recommend', { method:'POST', headers: { 'Content-Type':'application/json' }, body: JSON.stringify({skills, topn: 10}) });
  const data = await res.json();
  const out = (data.results||[]).map(r => `
    <div class="card">
      <b>${r.career}</b>
      <div class="small">Match: ${Math.round(r.match*100)}%</div>
      <div class="small">Learn next: ${r.top_skills.slice(0,8).join(', ')}</div>
      <div class="small">${(r.links||[]).map(l=>`<a href="${l.url}" target="_blank">${l.name}</a>`).join(' • ')}</div>
    </div>
  `).join('');
  document.getElementById('results').innerHTML = out || '<div class="small">No matches yet. Try more core skills.</div>';
}

async function suggest(q){
  if(!q){ document.getElementById('sugg').innerHTML=''; return; }
  const res = await fetch('/api/suggest?q='+encodeURIComponent(q));
  const data = await res.json();
  const skills = (data.skills||[]).map(s=>`<span class="badge">${s}</span>`).join(' ');
  const careers = (data.careers||[]).map(s=>`<span class="badge">${s}</span>`).join(' ');
  document.getElementById('sugg').innerHTML = '<div class="small"><b>Skills:</b> '+skills+'</div><div class="small"><b>Careers:</b> '+careers+'</div>';
}
</script>
{% endblock %}
